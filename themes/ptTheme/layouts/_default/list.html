{{ define "main" }}
<style>
  .card-header{
    background: rgb(63,94,251);
    background: radial-gradient(circle, rgba(63,94,251,1) 0%, rgba(70,216,252,1) 100%);
    height: 25px;
  }
</style>
<div class="container-fluid">
<div class="card-deck my-2">
  <div class="card bg-preparation mb-2 mx-1" style="min-width: 12rem;">
    <div class="card-body">
      <h5 class="card-title"><strong>Preparation</strong></h5>
      <p class="card-text">Developing a partnership</p>
    </div>
    <div class="card-footer">
      <small class="text-muted">Click to See Blindspots</small>
    </div>
  </div>
  <div class="card bg-exploration mb-2 mx-1" style="min-width: 12rem;">
    <div class="card-body">
      <h5 class="card-title"><strong>Exploration</strong></h5>
      <p class="card-text">Building shared vision and values</p>
    </div>
    <div class="card-footer">
      <small class="text-muted">Click to See Blindspots</small>
    </div>
  </div>
  <div class="card bg-negotiation  mb-2 mx-1" style="min-width: 12rem;">
    <div class="card-body">
      <h5 class="card-title"><strong>Negotiation</strong></h5>
      <p class="card-text">Planning for mechanisms</p>
    </div>
    <div class="card-footer">
      <small class="text-muted">Click to See Blindspots</small>
    </div>
  </div>
  <div class="card bg-implementation mb-2 mx-1" style="min-width: 12rem;">
    <div class="card-body">
      <h5 class="card-title"><strong>Implementation</strong></h5>
      <p class="card-text">Undertaking work</p>
    </div>
    <div class="card-footer">
      <small class="text-muted">Click to See Blindspots</small>
    </div>
  </div>
  <div class="card bg-translation mb-2 mx-1" style="min-width: 12rem;">
    <div class="card-body">
      <h5 class="card-title"><strong>Translation</strong></h5>
      <p class="card-text">Short text needed</p>
    </div>
    <div class="card-footer">
      <small class="text-muted">Click to See Blindspots</small>
    </div>
  </div>
</div>
</div>

{{ $paginator := (.Paginator 80).Pages}}
<div class="home">
    <div class="container">
      {{ range $phase := (slice "Preparation" "Exploration" "Negotiation" "Implementation" "Translation")}}
      <div class="card bg-{{ lower $phase }} my-2">
        <div class="card-body">
          <h5 class="card-title">
            <strong>Blindspots for {{ $phase }}</strong>
          </h5>
        {{ range $paginator }}   
          {{ $file := .Params.datafile}}
          {{ $index := .Params.index }}
          {{ if $file }}
              {{ $blindspots := getJSON $file }} 
                {{ $blindspot := index $blindspots $index }}      
                  {{ range $bsPhase := $blindspot.partnership_phase }}

                    {{ if eq $phase $bsPhase }}
                    <p>{{ $phase }}: {{ $blindspot.blindspot_name }}</p>
                  {{ end}}
              {{ end }}
          {{ end }}
          {{ end }}
        </div>
      </div>
      {{ end }}

      {{/*
           <!-- quick fix to itterate.  Can generate something better if needed -->
        {{ range (.Paginator 30).Pages }}   
            <div class="card ">
             <a href="{{ .Permalink }}" class="index-anchor">    
                <div class="panel panel-default">
                  <div class="card-header">
                    {{ . }}
                  </div>
                  <div class="panel-body">
                    {{ $file := .Params.datafile}}
                    {{ $index := .Params.index }}
                    {{ if $file }}
                        {{ $blindspots := getJSON $file }} 
                        {{ $blindspot := index $blindspots $index }}          
                        <h3 class="panel-title pull-left">{{ $blindspot.blindspot_name }}</h3>
                        <br />
                        <span class="post-meta pull-left"><small>{{ range $blindspot.partnership_phase }}
                          <span class="badge badge-{{ lower . }}">{{ . }}</span> <!-- The . represents an element in $array -->
                      {{ end }}</small></span>
                    {{ end }}
                  </div>
                  
                  <div class="panel-body">
                    <small>
                      {{ .Summary | plainify | truncate 180 }}
                    </small>
                  </div>
                </div>
                </a>
            </div>
          {{ end }}
    </div> 
    
<div class="row">
    <div class="col-md-4">  </div>
    <div class="col-md-4">
        {{ if gt .Paginator.TotalPages 1 }}
        <ul class="pagination">
          {{ if .Paginator.HasPrev }}
            <li><a href="{{ .Paginator.Prev.URL }}">&laquo; Prev</a></li>
          {{ else }}
            <li><span>&laquo; Prev</span></li>
          {{ end }}

          {{ $scratch := newScratch }}
          {{ $scratch.Set "current" .Paginator.PageNumber }} 

          {{ range .Paginator.Pagers }}
            {{ if eq .PageNumber ($scratch.Get "current") }}
              <li class="active"><span><em>{{ .PageNumber }}</em></span></li>
            {{ else }}
            <li><a href="{{ .URL }}">{{ .PageNumber }}</a></li>
            {{ end }}
          {{ end }}

          {{ if .Paginator.HasNext }}
            <li><a href="{{ .Paginator.Next.URL }}">Next &raquo;</a></li>
          {{ else }}
            <li><span >Next &raquo;</span></li>
          {{ end }}
          </ul>
        {{ end }}
    </div> 
</div>*/}}
{{ end }}

